<!DOCTYPE html>
<html lang="ko" data-screen-id="0060" data-targets="개인사업자" data-action="정보조회" data-core-call="true">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>한도부여결과조회 (0060)</title>
  <style>
    :root{
      --text:#111; --muted:#666; --line:#e6e6e6; --bg:#f7f8fa;
      --kb-yellow:#ffcc00; --kb-yellow-dark:#f2b800;
      --card:#fff; --danger:#e53935; --panel:#fafafa;
      --field-bg:#fff; --field-line:#d9d9d9;
    }
    *{ box-sizing:border-box; }
    body{ margin:0; font-family: "Malgun Gothic", Arial, sans-serif; background: var(--bg); color: var(--text); }
    .wrap{ max-width:520px; margin:0 auto; min-height:100vh; background:#fff; padding-bottom:86px; border-left:1px solid rgba(0,0,0,.06); border-right:1px solid rgba(0,0,0,.06); }
    .topbar{ height:56px; display:flex; align-items:center; justify-content:center; position:sticky; top:0; background:#fff; z-index:20; border-bottom:1px solid rgba(0,0,0,.08); padding:0 14px; }
    .topbar .title{ font-weight:900; font-size:16px; letter-spacing:-.2px; display:flex; gap:6px; align-items:baseline; }
    .topbar .title small{ font-size:12px; font-weight:900; color:var(--muted); }
    .topbar .close{ position:absolute; right:12px; top:50%; transform:translateY(-50%); width:38px; height:38px; border-radius:10px; display:flex; align-items:center; justify-content:center; cursor:pointer; color:#333; user-select:none; }
    .topbar .close:hover{ background:#fafafa; border:1px solid rgba(0,0,0,.10); }
    .content{ padding:12px 16px 12px; }

    .subhead{ display:flex; align-items:center; justify-content:space-between; gap:12px; padding:10px 0 8px; }
    .subhead .label{ font-weight:900; font-size:15px; letter-spacing:-.2px; }
    .steps{ display:flex; gap:8px; align-items:center; }
    .step{ width:26px; height:26px; border-radius:999px; display:flex; align-items:center; justify-content:center; font-weight:900; font-size:12px; border:1px solid rgba(0,0,0,.10); background:#f0f2f4; color:#666; user-select:none; }
    .step.done{ background:#e9ecef; color:#666; }
    .step.current{ background:#4f7cff; border-color:rgba(0,0,0,.06); color:#fff; }

    .hero{ margin-top:6px; border-radius:12px; background:#eef1f3; border:1px solid rgba(0,0,0,.08); padding:14px 12px; position:relative; overflow:hidden; }
    .hero .row{ display:flex; gap:12px; align-items:center; }
    .hero .img{ width:86px; height:54px; border-radius:10px; border:1px solid rgba(0,0,0,.10); background:linear-gradient(135deg, rgba(255,255,255,.9), rgba(255,255,255,.35)); box-shadow:0 8px 18px rgba(0,0,0,.08); display:flex; align-items:center; justify-content:center; font-weight:900; color:#666; font-size:12px; }
    .hero .t1{ font-size:14px; font-weight:900; color:#333; margin-bottom:6px; }
    .hero .t2{ font-size:26px; font-weight:900; letter-spacing:-.6px; line-height:1.1; color:#111; }
    .hero .t2 small{ font-size:16px; font-weight:900; color:#333; }

    .section{ margin-top:14px; border:1px solid rgba(0,0,0,.10); border-radius:12px; overflow:hidden; background:#fff; }
    .section-title{ padding:12px 12px; font-weight:900; font-size:14px; background:#fff; border-bottom:1px solid var(--line); display:flex; align-items:center; justify-content:space-between; gap:10px; }
    .table{ width:100%; border-collapse:collapse; font-size:13.5px; }
    .table tr{ border-bottom:1px solid var(--line); }
    .th, .td{ padding:12px 10px; vertical-align:middle; }
    .th{ width:42%; color:#222; font-weight:900; background:#fafafa; border-right:1px solid var(--line); }
    .td{ background:#fff; }
    .field{ width:100%; height:44px; border:1px solid var(--field-line); border-radius:10px; padding:0 12px; background:var(--field-bg); outline:none; font-size:14px; }
    .field[readonly]{ background:#f3f4f6; color:#444; }

    .notice{ padding:12px 12px 2px; }
    .notice .title{ display:flex; align-items:center; gap:6px; font-weight:900; font-size:14px; }
    .bullets{ margin:8px 0 10px; padding:12px 12px; border-radius:10px; background:#fafafa; border:1px solid var(--line); }
    .bullets h4{ margin:0 0 8px; font-size:14px; font-weight:900; }
    .bullets ul{ margin:0; padding-left:18px; color:#222; font-size:13px; line-height:1.6; }

    .bottom{ position:fixed; left:50%; transform:translateX(-50%); bottom:0; width:min(520px, 100vw); border-top:1px solid rgba(0,0,0,.08); background:#fff; z-index:30; padding:10px 12px; }
    .next{ width:100%; height:56px; border:none; border-radius:12px; background:var(--kb-yellow); color:#111; font-weight:900; font-size:16px; cursor:pointer; letter-spacing:-.2px; }
    .next:hover{ background:var(--kb-yellow-dark); }
    .next:active{ transform:translateY(1px); }

    /* 요구사항 모달 */
    .req-qmark{ position:fixed; right:14px; bottom:94px; width:44px; height:44px; border-radius:999px; border:1px solid rgba(0,0,0,.18); background:var(--kb-yellow); color:#111; font-weight:900; font-size:22px; cursor:pointer; box-shadow:0 10px 22px rgba(0,0,0,.14); opacity:.82; transition: opacity .15s ease, transform .05s ease, background .15s ease; z-index:1000; }
    .req-qmark:hover{ opacity:1; background:var(--kb-yellow-dark); }
    .req-qmark:active{ transform:translateY(1px); }
    .spec-modal-root{ position:fixed; inset:0; background:rgba(0,0,0,.55); display:none; align-items:center; justify-content:center; padding:18px; z-index:1200; }
    .spec-modal-root.show{ display:flex; }
    .spec-modal{ width:min(980px, 100%); max-height:min(86vh, 900px); overflow:auto; background:#fff; border-radius:12px; box-shadow:0 20px 60px rgba(0,0,0,.25); border:1px solid rgba(0,0,0,.15); }
    .spec-modal__head{ display:flex; align-items:center; justify-content:space-between; gap:12px; padding:14px 16px; border-bottom:1px solid #e6e6e6; position:sticky; top:0; background:#fff; }
    .spec-modal__title{ font-size:16px; font-weight:900; letter-spacing:-.2px; }
    .spec-modal__close{ border:1px solid rgba(0,0,0,.18); background:#fff; border-radius:8px; padding:8px 10px; cursor:pointer; font-weight:900; }
    .spec-modal__body{ padding:14px 16px 18px; }
    .kv{ display:grid; grid-template-columns:170px 1fr; border:1px solid #e6e6e6; border-radius:10px; overflow:hidden; margin-bottom:12px; }
    .kv .k, .kv .v{ padding:10px 12px; border-bottom:1px solid #e6e6e6; font-size:13px; line-height:1.5; }
    .kv .k{ background:#fafafa; font-weight:900; color:#333; border-right:1px solid #e6e6e6; }
    .kv .v{ color:#222; }
    .chips{ display:flex; flex-wrap:wrap; gap:8px; margin-bottom:10px; }
    .chip{ font-size:12px; border:1px solid rgba(0,0,0,.12); background:#fafafa; padding:6px 10px; border-radius:999px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace; }
    .section2{ margin-top:12px; padding:12px 12px; border:1px solid #e6e6e6; border-radius:10px; background:#fff; }
    .section2__title{ font-weight:900; font-size:13px; margin:0 0 8px; }
    .section2 ul{ margin:0; padding-left:18px; color:#222; font-size:13px; line-height:1.6; }
    .code{ margin-top:10px; padding:10px 12px; border-radius:10px; background:#0b0b0d; color:#e9e9ef; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace; font-size:12px; line-height:1.55; overflow:auto; white-space:pre; }
    .toast{ position:fixed; left:50%; bottom:86px; transform:translateX(-50%); background:rgba(0,0,0,.86); color:#fff; padding:10px 14px; border-radius:12px; font-size:14px; opacity:0; pointer-events:none; transition:opacity .18s ease; max-width:min(480px, calc(100vw - 24px)); text-align:center; z-index:60; }
    .toast.show{ opacity:1; }
  </style>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable-dynamic-subset.min.css"/>
  <link rel="stylesheet" href="css/kb-theme.css"/>
  <link rel="stylesheet" href="css/common.css" />
</head>

<body>
  <!--
    [요건 주석: 0060 한도부여결과조회(개사자전용)]
    - 대상: 법인 N / 개인 Y
    - Action: 정보조회
    - 처리계 거래: Y (심사)
    - 목적: 부여한도 확인 및 안내(고객에게 심사부여한도 고지)
    - 입력: 없음(조회 결과 표시)
    - 규칙: 값 미수신/오류 시 안내 토스트 및 재시도 유도
    - 다음 화면: 0061(신분증 정보) 또는 0062(필수확인사항, 개인전용) 등 흐름 정책에 맞춰 연결
  -->
  <div class="wrap" role="application" aria-label="한도부여결과조회 (0060)">

    <div class="topbar" role="banner">
      <div class="title">카드신청 <small>(0060)</small></div>
      <div class="close" id="closeBtn" aria-label="닫기">×</div>
    </div>

    <div class="content">
      <div class="subhead">
        <div class="label">본인확인</div>
        <div class="steps" aria-label="진행 단계">
          <div class="step done" aria-label="1단계 완료">✓</div>
          <div class="step current" aria-label="2단계 현재">2</div>
          <div class="step" aria-label="3단계">3</div>
          <div class="step" aria-label="4단계">4</div>
        </div>
      </div>

      <!-- 히어로: 안내 (이미지 바인딩 지원) -->
      <div class="hero" aria-label="안내 배너">
        <div class="row">
          <img class="img" alt="0060 히어로" data-image-key="img_0060_hero" />
          <div>
            <div class="t1"><b id="custName">파이썬상상더고객님</b><br/>신용카드 심사부여한도를 확인하세요.</div>
            <div class="t2">ONE KB국민 <small>global</small><br/>기업카드</div>
          </div>
        </div>
      </div>

      <!-- 조회 결과 -->
      <div class="section" aria-label="조회결과">
        <div class="section-title">
          업체 총한도(심사부여한도)
        </div>
        <table class="table" aria-label="심사부여한도 결과">
          <tr>
            <td class="th">심사부여한도</td>
            <td class="td" style="display:flex; align-items:center; gap:8px;">
              <input id="limitAmt" class="field" type="text" value="100" readonly aria-readonly="true" data-req-id="심사부여한도" />
              <span style="font-weight:900; color:#666;">만원</span>
            </td>
          </tr>
        </table>
      </div>

      <!-- 유의사항 -->
      <div class="section" aria-label="유의사항">
        <div class="section-title">유의사항</div>
        <div class="notice">
          <div class="bullets">
            <h4>기업카드 한도 안내</h4>
            <ul>
              <li><b>업체총한도</b>: 신용평가 심사를 통해 <u>사업자번호 기준</u>으로 부여되는 전체 한도</li>
              <li><b>부서별한도</b>: 업체의 기업카드 이용 편의를 제공하기 위한 단위이며, 결제계좌/결제일이 같은 기업카드 결제 단위(1부서 1청구서)</li>
              <li><b>기업카드별 한도</b>: 해당 카드에 부여된 한도이며 부여 한도 범위 내 이용 가능. 별도 지정이 없을 경우 1,000만원 일괄 부여되며, 부서별 한도가 1,000만원 이내일 경우 부서한도만큼 부여됨</li>
              <li>부서한도 합산이 업체총한도를 초과할 수 없습니다. 부서의 총 이용액이 업체총한도를 초과하지 않도록 유의해 주세요.</li>
            </ul>
          </div>
        </div>
      </div>
    </div><!-- /content -->
  </div><!-- /wrap -->

  <!-- 하단 버튼 -->
  <div class="bottom" role="contentinfo" aria-label="하단 버튼">
    <button class="next" id="nextBtn" type="button">다음</button>
  </div>

  <!-- 토스트 -->
  

  <!-- 요구사항 버튼 -->
  <button id="reqBtn" class="req-qmark" type="button" aria-label="기능요구서 보기">?</button>

  <!-- 요구사항/주석 모달 -->
  <div id="specModalRoot" class="spec-modal-root" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="spec-modal" aria-label="업무 정의서 및 주석">
      <div class="spec-modal__head">
        <div id="specModalTitle" class="spec-modal__title">업무 정의서 / 주석 (0060)</div>
        <button id="specModalClose" class="spec-modal__close" type="button">닫기</button>
      </div>
      <div id="specModalBody" class="spec-modal__body"></div>
    </div>
  </div>

  <script>
    // Generated for 0060 by Copilot
    (function(){
      const SCREEN_ID = "0060";
      const SCREEN_NAME = "한도부여결과조회(개사자전용)";
      const CHANNEL = "mobile web (개인사업자)";

      const $ = (id) => document.getElementById(id);
      const toast = $("toast");

      // 이미지 매핑: 전달받으면 채워 넣습니다.
      const IMG_MAP = {
        // 'img_0060_hero': '/assets/0060_hero.png'
      };
      document.querySelectorAll('[data-image-key]').forEach($img => {
        const key = $img.getAttribute('data-image-key');
        if (IMG_MAP[key]) $img.src = IMG_MAP[key];
        else $img.setAttribute('aria-hidden', 'true');
      });

      function showToast(msg){
        toast.textContent = msg;
        toast.classList.add("show");
        setTimeout(()=> toast.classList.remove("show"), 1600);
      }

      // 닫기(목업)
      $("closeBtn").addEventListener("click", ()=> showToast("닫기(모의): 이전 화면 유지"));

      // 다음: 흐름 정책에 맞춰 연결 (예: 0061 또는 0062)
      $("nextBtn").addEventListener("click", ()=>{
        showToast("다음(모의): 다음 단계로 이동");
        if (window.ScenarioNav) {
ScenarioNav.goNext();
      } else {
              location.hash = "#/0061";
            }
          }
        } // 가정: 신분증 정보(개인전용)
      });

      // 요구사항 스펙 (컨텍스트 정의 반영)
      

      // 스펙 모달
      const specModalRoot = $("specModalRoot");
      const specModalClose = $("specModalClose");
      const specModalTitle = $("specModalTitle");
      const specModalBody = $("specModalBody");
      const reqBtn = $("reqBtn"); // [수정] 올바른 ID 선택

      // [수정] 누락된 escapeHtml 함수 복원
      function escapeHtml(text){
        if(!text) return "";
        return String(text)
          .replace(/&/g, "&amp;")
          .replace(/</g, "&lt;")
          .replace(/>/g, "&gt;")
          .replace(/"/g, "&quot;")
          .replace(/'/g, "&#039;");
      }

      function renderSpec(spec){
        document.title = `${spec.screen_name} (${spec.screen_id})`;
        specModalTitle.textContent = `업무 정의서 / 주석 (${spec.screen_id}) · ${spec.screen_name}`;

        const chips = [
          `ID:${spec.screen_id}`,
          `Action:${spec.action}`,
          `Channel:${spec.channel}`,
          `CoreCall:${spec.processing_core_call ? "Y" : "N"}`
        ];

        specModalBody.innerHTML = `
          <div class="kv">
            <div class="k">기능 ID</div><div class="v"><b>${escapeHtml(spec.screen_id)}</b></div>
            <div class="k">기능명</div><div class="v"><b>${escapeHtml(spec.screen_name)}</b></div>
            <div class="k">채널</div><div class="v">${escapeHtml(spec.channel)}</div>
            <div class="k">대상</div><div class="v">${escapeHtml(spec.targets || "-")}</div>
            <div class="k">Action</div><div class="v">${escapeHtml(spec.action)}</div>
            <div class="k">목적</div><div class="v">${escapeHtml(spec.purpose)}</div>
            <div class="k">처리계호출</div><div class="v">${spec.processing_core_call ? "Y" : "N"}</div>
          </div>

          <div class="chips">${chips.map(c=>`<span class="chip">${escapeHtml(c)}</span>`).join("")}</div>

          <div class="section2">
            <div class="section2__title">출력/표시 필드</div>
            <ul>${(spec.fields||[]).map(f=>`<li><b>${escapeHtml(f.key)}</b> · ${f.required ? "필수" : "선택"} · ${escapeHtml(f.type)}${f.unit ? ` [단위:${escapeHtml(f.unit)}]` : ""}${f.note ? ` (${escapeHtml(f.note)})` : ""}</li>`).join("")}</ul>
          </div>

          <div class="section2">
            <div class="section2__title">제어 규칙</div>
            <ul>${(spec.control_rules||[]).map(x=>`<li>${escapeHtml(x)}</li>`).join("")}</ul>
          </div>

          <div class="section2">
            <div class="section2__title">처리/연동</div>
            <ul>
              <li>도메인: ${escapeHtml(spec.backend.domain)}</li>
              <li>거래: ${escapeHtml(spec.backend.txn)}</li>
              <li>비고: ${escapeHtml(spec.backend.notes)}</li>
            </ul>
          </div>

          <div class="section2">
            <div class="section2__title">감사/로그 포인트</div>
            <ul>${(spec.audit_log_points||[]).map(x=>`<li>${escapeHtml(x)}</li>`).join("")}</ul>
          </div>

          <div class="section2">
            <div class="section2__title">주석(개발/QA 포인트)</div>
            <ul>${(spec.notes||[]).map(x=>`<li>${escapeHtml(x)}</li>`).join("")}</ul>
          </div>

          <div class="section2">
            <div class="section2__title">REQ_SPEC 원문(JSON)</div>
            <div class="code">${escapeHtml(JSON.stringify(spec, null, 2))}</div>
          </div>
        `;
      }
      function openSpec(){ renderSpec(REQ_SPEC); specModalRoot.classList.add("show"); specModalRoot.setAttribute("aria-hidden", "false"); }
      function closeSpec(){ specModalRoot.classList.remove("show"); specModalRoot.setAttribute("aria-hidden", "true"); }

      reqBtn.addEventListener("click", openSpec);
      specModalClose.addEventListener("click", closeSpec);
      specModalRoot.addEventListener("click", (e)=>{ if(e.target === specModalRoot) closeSpec(); });
      document.addEventListener("keydown", (e)=>{
        if(e.key === "Escape" && specModalRoot.classList.contains("show")) closeSpec();
        if(e.ctrlKey && e.altKey && (e.key === "r" || e.key === "R")){
          if(specModalRoot.classList.contains("show")) closeSpec(); else openSpec();
        }
      });

      // (옵션) 조회 값 예시 주입: 실제 연동 시 제거하고 응답 바인딩
      const exampleValue = "100";
      const $limit = $("limitAmt");
      if($limit && !$limit.value) $limit.value = exampleValue;
    })();
  </script>
<script src="js/common.js"></script>
<script src="js/session-db.js"></script>
<script src="js/scenario-nav.js"></script>
<script src="js/spec-viewer.js" data-screen-id="0060"></script>
</body>
</html>